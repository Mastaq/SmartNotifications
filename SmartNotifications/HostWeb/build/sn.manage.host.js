/// <reference path="_references.ts" />
var SN;
(function (SN) {
    var sod = SP.SOD;
    var SPAsyncScript = (function () {
        function SPAsyncScript(key, src, onLoad) {
            var _this = this;
            this.key = key;
            this.src = src;
            this.onLoad = onLoad;
            this.onLoadFunction = function () {
                if (typeof sod.notifyScriptLoadedAndExecuteWaitingJobs === "function") {
                    sod.notifyScriptLoadedAndExecuteWaitingJobs(_this.key);
                }
                if (_this.onLoad && typeof _this.onLoad === "function") {
                    _this.onLoad();
                }
            };
            this.load = function (sync) {
                if (sync === void 0) { sync = false; }
                sod.loadMultiple([_this.key], _this.onLoadFunction, sync);
            };
            this.registerDependency = function (asyncScripts) {
                asyncScripts.forEach(function (asyncScript) {
                    sod.registerSodDep(_this.key, asyncScript.key);
                });
            };
            this.registerDependencyByName = function (kies) {
                kies.forEach(function (key) {
                    sod.registerSodDep(_this.key, key);
                });
            };
            sod.registerSod(this.key, this.src);
        }
        return SPAsyncScript;
    })();
    SN.SPAsyncScript = SPAsyncScript;
})(SN || (SN = {}));
/// <reference path="_references.ts" />
var SN;
(function (SN) {
    var ManageAppViewModel = (function () {
        function ManageAppViewModel() {
            var _this = this;
            this.hasPermissions = ko.observable(false);
            this.loaded = ko.observable(false);
            var context = SP.ClientContext.get_current();
            context.load(context.get_web(), "EffectiveBasePermissions");
            this.hasPermissions(false);
            context.executeQueryAsync(function () {
                _this.loaded(true);
                _this.hasPermissions(context.get_web().get_effectiveBasePermissions().has(SP.PermissionKind.manageWeb));
            }, function (s, e) {
                alert(e.get_message());
            });
        }
        return ManageAppViewModel;
    })();
    SN.ManageAppViewModel = ManageAppViewModel;
})(SN || (SN = {}));
/// <reference path="_references.ts" />
var SN;
(function (SN) {
    (function (window) {
        SP.SOD.executeOrDelayUntilScriptLoaded(function () {
            function onkoLoaded() {
                jQuery.get("../templates.html")
                    .then(function (data) {
                    jQuery("body").append("<div style=\"display:none\">" + data + "<\/div>");
                    ko.applyBindings(new SN.ManageAppViewModel(), document.getElementById("sn-manage-app"));
                });
            }
            function onjQueryLoaded() {
                if (!window.ko) {
                    var koLoader = new SN.SPAsyncScript("knockout", "../knockout.js", onkoLoaded);
                    koLoader.load();
                }
                else {
                    onkoLoaded();
                }
            }
            if (!window.jQuery) {
                window.registerCssLink("../bootstrap.css");
                window.registerCssLink("../styles.css");
                var jqLoader = new SN.SPAsyncScript("jquery", "../jquery.js", onjQueryLoaded);
                jqLoader.load();
            }
            else {
                onjQueryLoaded();
            }
        }, "sp.js");
    })(window);
})(SN || (SN = {}));
/// <reference path="../../../typings/tsd.d.ts" />
///<reference path="SPAsyncScript.ts" />
///<reference path="ManageAppViewModel.ts" />
///<reference path="Loader.ts" />

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlNQQXN5bmNTY3JpcHQudHMiLCJNYW5hZ2VBcHBWaWV3TW9kZWwudHMiLCJMb2FkZXIudHMiLCJfcmVmZXJlbmNlcy50cyJdLCJuYW1lcyI6WyJTTiIsIlNOLlNQQXN5bmNTY3JpcHQiLCJTTi5TUEFzeW5jU2NyaXB0LmNvbnN0cnVjdG9yIiwiU04uTWFuYWdlQXBwVmlld01vZGVsIiwiU04uTWFuYWdlQXBwVmlld01vZGVsLmNvbnN0cnVjdG9yIiwiU04ub25rb0xvYWRlZCIsIlNOLm9ualF1ZXJ5TG9hZGVkIl0sIm1hcHBpbmdzIjoiQUFBRyx1Q0FBdUM7QUFFMUMsSUFBVSxFQUFFLENBeUNYO0FBekNELFdBQVUsRUFBRSxFQUFDLENBQUM7SUFFYkEsSUFBT0EsR0FBR0EsR0FBR0EsRUFBRUEsQ0FBQ0EsR0FBR0EsQ0FBQ0E7SUFRcEJBO1FBQ0NDLHVCQUFvQkEsR0FBV0EsRUFBVUEsR0FBV0EsRUFBVUEsTUFBa0JBO1lBRGpGQyxpQkE4QkNBO1lBN0JvQkEsUUFBR0EsR0FBSEEsR0FBR0EsQ0FBUUE7WUFBVUEsUUFBR0EsR0FBSEEsR0FBR0EsQ0FBUUE7WUFBVUEsV0FBTUEsR0FBTkEsTUFBTUEsQ0FBWUE7WUFJeEVBLG1CQUFjQSxHQUFHQTtnQkFDeEJBLEVBQUVBLENBQUNBLENBQUNBLE9BQU9BLEdBQUdBLENBQUNBLHVDQUF1Q0EsS0FBS0EsVUFBVUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7b0JBQ3ZFQSxHQUFHQSxDQUFDQSx1Q0FBdUNBLENBQUNBLEtBQUlBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO2dCQUN2REEsQ0FBQ0E7Z0JBRURBLEVBQUVBLENBQUNBLENBQUNBLEtBQUlBLENBQUNBLE1BQU1BLElBQUlBLE9BQU9BLEtBQUlBLENBQUNBLE1BQU1BLEtBQUtBLFVBQVVBLENBQUNBLENBQUNBLENBQUNBO29CQUN0REEsS0FBSUEsQ0FBQ0EsTUFBTUEsRUFBRUEsQ0FBQ0E7Z0JBQ2ZBLENBQUNBO1lBQ0ZBLENBQUNBLENBQUFBO1lBRURBLFNBQUlB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QU1BLENBQUNBLEdBQUdBLENBQUNBLG1CQUFtQkEsQ0FBQ0E7cUJBQzdCQSxJQUFJQSxDQUFDQSxVQUFBQSxJQUFJQTtvQkFDVEEsTUFBTUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsOEJBQThCQSxHQUFHQSxJQUFJQSxHQUFHQSxTQUFTQSxDQUFDQSxDQUFDQTtvQkFDekVBLEVBQUVBLENBQUNBLGFBQWFBLENBQUNBLElBQUlBLHFCQUFrQkEsRUFBRUEsRUFBRUEsUUFBUUEsQ0FBQ0EsY0FBY0EsQ0FBQ0EsZUFBZUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7Z0JBQ3RGQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNMQSxDQUFDQTtZQUVETDtnQkFDQ00sRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7b0JBQ2hCQSxJQUFJQSxRQUFRQSxHQUFHQSxJQUFJQSxnQkFBYUEsQ0FBQ0EsVUFBVUEsRUFBRUEsZ0JBQWdCQSxFQUFFQSxVQUFVQSxDQUFDQSxDQUFDQTtvQkFDM0VBLFFBQVFBLENBQUNBLElBQUlBLEVBQUVBLENBQUNBO2dCQUNqQkEsQ0FBQ0E7Z0JBQUNBLElBQUlBLENBQUNBLENBQUNBO29CQUNQQSxVQUFVQSxFQUFFQSxDQUFDQTtnQkFDZEEsQ0FBQ0E7WUFDRkEsQ0FBQ0E7WUFFRE4sRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7Z0JBQ3BCQSxNQUFNQSxDQUFDQSxlQUFlQSxDQUFDQSxrQkFBa0JBLENBQUNBLENBQUNBO2dCQUMzQ0EsTUFBTUEsQ0FBQ0EsZUFBZUEsQ0FBQ0EsZUFBZUEsQ0FBQ0EsQ0FBQ0E7Z0JBQ3hDQSxJQUFJQSxRQUFRQSxHQUFHQSxJQUFJQSxnQkFBYUEsQ0FBQ0EsUUFBUUEsRUFBRUEsY0FBY0EsRUFBRUEsY0FBY0EsQ0FBQ0EsQ0FBQ0E7Z0JBQzNFQSxRQUFRQSxDQUFDQSxJQUFJQSxFQUFFQSxDQUFDQTtZQUNqQkEsQ0FBQ0E7WUFDREEsSUFBSUEsQ0FBQ0EsQ0FBQ0E7Z0JBQ0xBLGNBQWNBLEVBQUVBLENBQUNBO1lBQ2xCQSxDQUFDQTtRQUNGQSxDQUFDQSxFQUFFQSxPQUFPQSxDQUFDQSxDQUFDQTtJQUNiQSxDQUFDQSxDQUFDQSxDQUFDQSxNQUFNQSxDQUFDQSxDQUFDQTtBQUNaQSxDQUFDQSxFQS9CUyxFQUFFLEtBQUYsRUFBRSxRQStCWDtBQ2pDQyxrREFBa0Q7QUFFcEQsd0NBQXdDO0FBQ3hDLDZDQUE2QztBQUM3QyxpQ0FBaUMiLCJmaWxlIjoic24ubWFuYWdlLmhvc3QuanMiLCJzb3VyY2VSb290IjoiLi9hcHAvbWFuYWdlIn0=
